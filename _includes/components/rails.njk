{# _includes/components/rails.njk #}
{% macro tagRail(title, tag, campaignSlug=null, limit=null) %}
  {% set base = collections.public_content or [] %}
  {% set rows = base | byTag(tag) %}
  {% if campaignSlug %}{% set rows = rows | where("data.campaignSlug", campaignSlug) %}{% endif %}
  {% set rows = rows | sortFeatured %}
  {% if rows | length %}
    <section class="cards">
      <h2>{{ title }}</h2>
      {% for p in rows | slice(0, limit or rows.length) %}
        <article class="card">
          <h3><a href="{{ p.url }}">{{ p.data.title }}</a></h3>
          {% if p.data.summary %}<p class="muted">{{ p.data.summary }}</p>{% endif %}
          {% if not campaignSlug and p.data.campaignSlug %}
            <p class="tiny muted">in {{ p.data.campaignSlug | replace("-", " ") | capitalize }}</p>
          {% endif %}
        </article>
      {% endfor %}
    </section>
  {% endif %}
{% endmacro %}

{% macro pinRail(title, key, limit=null) %}
  {% set pins = (collections[key] or []) | sortFeatured %}
  {% if pins.length %}
    <section class="cards">
      <h2>{{ title }}</h2>
      {% for p in pins | slice(0, limit or pins.length) %}
        <article class="card">
          <h3><a href="{{ p.url }}">{{ p.data.title }}</a></h3>
          {% if p.data.summary %}<p class="muted">{{ p.data.summary }}</p>{% endif %}
        </article>
      {% endfor %}
    </section>
  {% endif %}
{% endmacro %}
