---
title: Echoes Beneath the Mountains
layout: layout.njk
theme: tor
campaign: echoes
eleventyNavigation:
  key: Echoes
  parent: Home
  order: 1
---
<p>An original campaign set in the twilight years of the Third Age, as ancient secrets stir in the forgotten halls of Eregion and Moria.</p>

{% set campaign = campaignSlug or (campaign | slug) %}
{% set section  = type | slug %}

{% set items = (collections.public_content or [])
  | byCampaign(campaign)
  | where("data.section", section)
  | sortBy("data.title") %}

{# self guards #}
{% set currentUrl  = page.url or '' %}
{% set currentPath = page.inputPath %}
{% set sectionIndexUrl = "/vault/campaigns/" + campaign + "/" + section + "/" %}

<ul class="list">
  {% for it in items %}
    {% set isSelfOrIndex = (it.inputPath == currentPath)
                           or (it.url == currentUrl)
                           or (it.url == sectionIndexUrl)
                           or (it.page and it.page.fileSlug == "index") %}
    {% if not isSelfOrIndex %}
      <li><a href="{{ it.url }}">{{ it.data.title }}</a></li>
    {% endif %}
  {% endfor %}
</ul>


{# Optional “featured” pins on the landing: tag pages with `index:echoes:landing` #}
{% set pins = (collections["index:" + campaign + ":landing"] or []) | sortBy("data.indexOrder") %}
{% if pins.length %}
  <h2>Featured</h2>
  <ul class="list">
    {% for p in pins %}
      <li><a href="{{ p.url }}">{{ p.data.title }}</a></li>
    {% endfor %}
  </ul>
{% endif %}
